use anyhow::Result;
use evdev::uinput::VirtualDevice;
use evdev::{AttributeSet, KeyCode};

const SUPPORTED_KEYS: [KeyCode; 221] = [
    KeyCode::KEY_A,
    KeyCode::KEY_B,
    KeyCode::KEY_C,
    KeyCode::KEY_D,
    KeyCode::KEY_E,
    KeyCode::KEY_F,
    KeyCode::KEY_G,
    KeyCode::KEY_H,
    KeyCode::KEY_I,
    KeyCode::KEY_J,
    KeyCode::KEY_K,
    KeyCode::KEY_L,
    KeyCode::KEY_M,
    KeyCode::KEY_N,
    KeyCode::KEY_O,
    KeyCode::KEY_P,
    KeyCode::KEY_Q,
    KeyCode::KEY_R,
    KeyCode::KEY_S,
    KeyCode::KEY_T,
    KeyCode::KEY_U,
    KeyCode::KEY_V,
    KeyCode::KEY_W,
    KeyCode::KEY_X,
    KeyCode::KEY_Y,
    KeyCode::KEY_Z,
    KeyCode::KEY_0,
    KeyCode::KEY_1,
    KeyCode::KEY_2,
    KeyCode::KEY_3,
    KeyCode::KEY_4,
    KeyCode::KEY_5,
    KeyCode::KEY_6,
    KeyCode::KEY_7,
    KeyCode::KEY_8,
    KeyCode::KEY_9,
    KeyCode::KEY_F1,
    KeyCode::KEY_F2,
    KeyCode::KEY_F3,
    KeyCode::KEY_F4,
    KeyCode::KEY_F5,
    KeyCode::KEY_F6,
    KeyCode::KEY_F7,
    KeyCode::KEY_F8,
    KeyCode::KEY_F9,
    KeyCode::KEY_F10,
    KeyCode::KEY_F11,
    KeyCode::KEY_F12,
    KeyCode::KEY_F13,
    KeyCode::KEY_F14,
    KeyCode::KEY_F15,
    KeyCode::KEY_F16,
    KeyCode::KEY_F17,
    KeyCode::KEY_F18,
    KeyCode::KEY_F19,
    KeyCode::KEY_F20,
    KeyCode::KEY_F21,
    KeyCode::KEY_F22,
    KeyCode::KEY_F23,
    KeyCode::KEY_F24,
    KeyCode::KEY_KP0,
    KeyCode::KEY_KP1,
    KeyCode::KEY_KP2,
    KeyCode::KEY_KP3,
    KeyCode::KEY_KP4,
    KeyCode::KEY_KP5,
    KeyCode::KEY_KP6,
    KeyCode::KEY_KP7,
    KeyCode::KEY_KP8,
    KeyCode::KEY_KP9,
    KeyCode::KEY_KPASTERISK,
    KeyCode::KEY_KPCOMMA,
    KeyCode::KEY_KPDOT,
    KeyCode::KEY_KPENTER,
    KeyCode::KEY_KPEQUAL,
    KeyCode::KEY_KPMINUS,
    KeyCode::KEY_KPPLUS,
    KeyCode::KEY_KPPLUSMINUS,
    KeyCode::KEY_KPSLASH,
    KeyCode::KEY_102ND,
    KeyCode::KEY_AGAIN,
    KeyCode::KEY_ALTERASE,
    KeyCode::KEY_APOSTROPHE,
    KeyCode::KEY_BACK,
    KeyCode::KEY_BACKSLASH,
    KeyCode::KEY_BACKSPACE,
    KeyCode::KEY_BASSBOOST,
    KeyCode::KEY_BOOKMARKS,
    KeyCode::KEY_BRIGHTNESSDOWN,
    KeyCode::KEY_BRIGHTNESSUP,
    KeyCode::KEY_CALC,
    KeyCode::KEY_CAMERA,
    KeyCode::KEY_CANCEL,
    KeyCode::KEY_CAPSLOCK,
    KeyCode::KEY_CHAT,
    KeyCode::KEY_CLOSE,
    KeyCode::KEY_CLOSECD,
    KeyCode::KEY_COFFEE,
    KeyCode::KEY_COMMA,
    KeyCode::KEY_COMPOSE,
    KeyCode::KEY_COMPUTER,
    KeyCode::KEY_CONFIG,
    KeyCode::KEY_CONNECT,
    KeyCode::KEY_COPY,
    KeyCode::KEY_CUT,
    KeyCode::KEY_CYCLEWINDOWS,
    KeyCode::KEY_DASHBOARD,
    KeyCode::KEY_DELETE,
    KeyCode::KEY_DELETEFILE,
    KeyCode::KEY_DIRECTION,
    KeyCode::KEY_DOT,
    KeyCode::KEY_DOWN,
    KeyCode::KEY_EDIT,
    KeyCode::KEY_EJECTCD,
    KeyCode::KEY_EJECTCLOSECD,
    KeyCode::KEY_EMAIL,
    KeyCode::KEY_END,
    KeyCode::KEY_ENTER,
    KeyCode::KEY_EQUAL,
    KeyCode::KEY_ESC,
    KeyCode::KEY_EXIT,
    KeyCode::KEY_FASTFORWARD,
    KeyCode::KEY_FILE,
    KeyCode::KEY_FINANCE,
    KeyCode::KEY_FIND,
    KeyCode::KEY_FN,
    KeyCode::KEY_FORWARD,
    KeyCode::KEY_FRONT,
    KeyCode::KEY_GRAVE,
    KeyCode::KEY_HANGEUL,
    KeyCode::KEY_HANJA,
    KeyCode::KEY_HELP,
    KeyCode::KEY_HENKAN,
    KeyCode::KEY_HIRAGANA,
    KeyCode::KEY_HOME,
    KeyCode::KEY_HOMEPAGE,
    KeyCode::KEY_HP,
    KeyCode::KEY_INSERT,
    KeyCode::KEY_ISO,
    KeyCode::KEY_KATAKANA,
    KeyCode::KEY_KATAKANAHIRAGANA,
    KeyCode::KEY_KPJPCOMMA,
    KeyCode::KEY_KPLEFTPAREN,
    KeyCode::KEY_KPRIGHTPAREN,
    KeyCode::KEY_LEFT,
    KeyCode::KEY_LEFTALT,
    KeyCode::KEY_LEFTBRACE,
    KeyCode::KEY_LEFTCTRL,
    KeyCode::KEY_LEFTMETA,
    KeyCode::KEY_LEFTSHIFT,
    KeyCode::KEY_LINEFEED,
    KeyCode::KEY_MACRO,
    KeyCode::KEY_MAIL,
    KeyCode::KEY_MEDIA,
    KeyCode::KEY_MENU,
    KeyCode::KEY_MINUS,
    KeyCode::KEY_MOVE,
    KeyCode::KEY_MSDOS,
    KeyCode::KEY_MUHENKAN,
    KeyCode::KEY_MUTE,
    KeyCode::KEY_NEW,
    KeyCode::KEY_NEXTSONG,
    KeyCode::KEY_NUMLOCK,
    KeyCode::KEY_OPEN,
    KeyCode::KEY_PAGEDOWN,
    KeyCode::KEY_PAGEUP,
    KeyCode::KEY_PASTE,
    KeyCode::KEY_PAUSE,
    KeyCode::KEY_PAUSECD,
    KeyCode::KEY_PHONE,
    KeyCode::KEY_PLAY,
    KeyCode::KEY_PLAYCD,
    KeyCode::KEY_PLAYPAUSE,
    KeyCode::KEY_POWER,
    KeyCode::KEY_PREVIOUSSONG,
    KeyCode::KEY_PRINT,
    KeyCode::KEY_PROG1,
    KeyCode::KEY_PROG2,
    KeyCode::KEY_PROG3,
    KeyCode::KEY_PROG4,
    KeyCode::KEY_PROPS,
    KeyCode::KEY_QUESTION,
    KeyCode::KEY_RECORD,
    KeyCode::KEY_REDO,
    KeyCode::KEY_REFRESH,
    KeyCode::KEY_REWIND,
    KeyCode::KEY_RIGHT,
    KeyCode::KEY_RIGHTALT,
    KeyCode::KEY_RIGHTBRACE,
    KeyCode::KEY_RIGHTCTRL,
    KeyCode::KEY_RIGHTMETA,
    KeyCode::KEY_RIGHTSHIFT,
    KeyCode::KEY_RO,
    KeyCode::KEY_SCALE,
    KeyCode::KEY_SCROLLDOWN,
    KeyCode::KEY_SCROLLLOCK,
    KeyCode::KEY_SCROLLUP,
    KeyCode::KEY_SEARCH,
    KeyCode::KEY_SEMICOLON,
    KeyCode::KEY_SENDFILE,
    KeyCode::KEY_SETUP,
    KeyCode::KEY_SHOP,
    KeyCode::KEY_SLASH,
    KeyCode::KEY_SLEEP,
    KeyCode::KEY_SOUND,
    KeyCode::KEY_SPACE,
    KeyCode::KEY_SPORT,
    KeyCode::KEY_STOP,
    KeyCode::KEY_STOPCD,
    KeyCode::KEY_SUSPEND,
    KeyCode::KEY_SYSRQ,
    KeyCode::KEY_TAB,
    KeyCode::KEY_UNDO,
    KeyCode::KEY_UP,
    KeyCode::KEY_VOLUMEDOWN,
    KeyCode::KEY_VOLUMEUP,
    KeyCode::KEY_WAKEUP,
    KeyCode::KEY_WWW,
    KeyCode::KEY_XFER,
    KeyCode::KEY_YEN,
    KeyCode::KEY_ZENKAKUHANKAKU,
];

pub fn create_virtual_keyboard() -> Result<VirtualDevice> {
    let keys: AttributeSet<KeyCode> = SUPPORTED_KEYS.iter().collect();

    let dev = VirtualDevice::builder()?
        .name("midi2key keyboard")
        .with_keys(&keys)?
        .build()?;

    Ok(dev)
}
